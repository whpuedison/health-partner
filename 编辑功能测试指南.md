# 健康数据编辑功能测试指南

## ✅ 功能说明

在"健康"标签页中，用户可以点击"编辑资料"按钮，真实地编辑并保存以下信息：
- 身高（cm）
- 体重（kg）
- 年龄（岁）
- 性别（男/女）
- 体脂率（%，可选）

## 🧪 测试步骤

### 第1步：打开健康页面

1. 启动小程序
2. 点击底部导航栏的 **📊 健康** 标签
3. 应该看到"健康数据"和"体征记录"两个标签

### 第2步：点击编辑资料

1. 在"健康数据"标签下
2. 找到顶部的健康评分卡片
3. 点击卡片上的 **"编辑资料"** 按钮
4. 应该弹出编辑对话框

### 第3步：输入数据

在弹出的对话框中输入以下示例数据（或你自己的真实数据）：

```
身高：170
体重：70
年龄：28
性别：选择 "男" 或 "女"
体脂率：22.5（可选，可以不填）
```

### 第4步：保存数据

1. 点击 **"保存"** 按钮
2. 应该看到 "保存成功" 的提示
3. 对话框自动关闭
4. 页面数据自动更新

### 第5步：验证数据

保存成功后，检查以下内容：

#### ✅ 健康评分卡片
- 健康评分数值更新
- 健康状态文字更新
- 卡片背景色可能变化（根据评分）

#### ✅ BMI 卡片
- BMI 数值更新（应该显示计算后的值）
- BMI 指示器位置更新
- BMI 状态文字更新（偏瘦/正常/偏重/肥胖）

#### ✅ 身体数据卡片
- 身高显示正确
- 体重显示正确
- 年龄显示正确
- 体脂率显示正确

#### ✅ 健康建议
- 根据输入的数据显示个性化建议

## 📊 数据验证范围

系统会自动验证输入数据的合理性：

| 字段 | 最小值 | 最大值 | 说明 |
|------|--------|--------|------|
| 身高 | 100cm | 250cm | 必填 |
| 体重 | 30kg | 300kg | 必填 |
| 年龄 | 1岁 | 150岁 | 必填 |
| 体脂率 | 5% | 60% | 可选 |

### ❌ 错误提示测试

尝试以下操作，应该看到相应的错误提示：

1. **不填写身高** → "请填写完整信息"
2. **身高输入 50** → "身高范围：100-250cm"
3. **体重输入 500** → "体重范围：30-300kg"
4. **年龄输入 200** → "年龄范围：1-150岁"
5. **体脂率输入 80** → "体脂率范围：5-60%"

## 🔄 数据同步测试

### 测试数据持久化

1. 编辑并保存数据
2. 切换到其他页面（如"首页"）
3. 再切换回"健康"页面
4. **验证：** 数据应该保持不变

### 测试首页同步

1. 在"健康"页面编辑并保存数据
2. 切换到"首页"
3. **验证：** 首页的健康数据卡片应该显示更新后的数据

### 测试重启小程序

1. 编辑并保存数据
2. 完全退出小程序
3. 重新打开小程序
4. **验证：** 数据应该自动恢复

## 🎯 BMI 计算验证

使用以下公式手动验证 BMI 计算是否正确：

```
BMI = 体重(kg) / [身高(m)]²
```

**示例：**
- 身高：170cm = 1.7m
- 体重：70kg
- BMI = 70 / (1.7 × 1.7) = 70 / 2.89 ≈ 24.2

**BMI 评估标准：**
- BMI < 18.5 → 偏瘦
- 18.5 ≤ BMI < 24 → 正常
- 24 ≤ BMI < 28 → 偏重
- BMI ≥ 28 → 肥胖

## 🎨 UI 交互测试

### 对话框测试

1. **打开对话框**
   - ✅ 对话框居中显示
   - ✅ 半透明遮罩层
   - ✅ 表单字段清晰可见

2. **关闭对话框**
   - ✅ 点击遮罩层关闭
   - ✅ 点击右上角 "✕" 关闭
   - ✅ 点击"取消"按钮关闭
   - ✅ 保存成功后自动关闭

3. **表单输入**
   - ✅ 数字键盘正确弹出
   - ✅ 输入框可以正常输入
   - ✅ 单选按钮可以切换
   - ✅ 已有数据正确回显

### 按钮状态测试

1. **编辑资料按钮**
   - ✅ 按钮可点击
   - ✅ 点击有反馈效果

2. **保存按钮**
   - ✅ 渐变背景
   - ✅ 点击有效果
   - ✅ 保存成功显示提示

3. **取消按钮**
   - ✅ 灰色背景
   - ✅ 点击关闭对话框
   - ✅ 不保存数据

## 📱 示例测试用例

### 测试用例1：新用户首次录入

**操作步骤：**
1. 清除所有数据（个人中心 → 清除所有数据）
2. 进入健康页面
3. 点击"编辑资料"
4. 输入：身高170、体重70、年龄28、性别男、体脂率22
5. 点击保存

**预期结果：**
- ✅ 保存成功提示
- ✅ BMI 显示约 24.2
- ✅ 状态显示"偏重"
- ✅ 健康评分 60-80 分
- ✅ 首页数据同步更新

### 测试用例2：修改现有数据

**操作步骤：**
1. 在已有数据的基础上
2. 点击"编辑资料"
3. 修改体重为 65kg
4. 点击保存

**预期结果：**
- ✅ 保存成功提示
- ✅ BMI 更新为约 22.5
- ✅ 状态可能变为"正常"
- ✅ 健康评分提高

### 测试用例3：边界值测试

**操作步骤：**
1. 输入最小值：身高100、体重30、年龄1
2. 保存
3. 验证数据正确保存
4. 再次编辑
5. 输入最大值：身高250、体重300、年龄150
6. 保存
7. 验证数据正确保存

**预期结果：**
- ✅ 所有边界值都能正确保存
- ✅ BMI 计算正确
- ✅ 不会出现错误

### 测试用例4：空值测试

**操作步骤：**
1. 点击"编辑资料"
2. 清空所有必填字段
3. 点击保存

**预期结果：**
- ✅ 显示"请填写完整信息"提示
- ✅ 对话框不关闭
- ✅ 数据不被保存

## 🐛 已知问题排查

### 问题：点击"编辑资料"没反应

**排查：**
1. 检查控制台是否有错误
2. 确认已构建 npm
3. 尝试重新编译

### 问题：保存后数据没更新

**排查：**
1. 打开 AppData 查看页面数据
2. 查看控制台日志

### 问题：BMI 计算不正确

**排查：**
1. 手动计算验证公式
2. 检查输入的身高和体重
3. 确认身高单位是 cm（不是 m）

### 问题：性别选择无法切换

**排查：**
1. 检查 radio-group 绑定
2. 确认 onGenderChange 方法存在
3. 查看控制台错误

## 📝 测试检查清单

- [ ] 可以打开编辑对话框
- [ ] 所有输入框可以输入
- [ ] 性别单选可以切换
- [ ] 可以点击保存按钮
- [ ] 保存成功显示提示
- [ ] 对话框自动关闭
- [ ] 页面数据立即更新
- [ ] BMI 计算正确
- [ ] 健康评分更新
- [ ] 数据持久化保存
- [ ] 切换页面数据不丢失
- [ ] 重启小程序数据保留
- [ ] 首页数据同步更新
- [ ] 输入验证正确
- [ ] 错误提示准确

## 🎉 功能完成度

- ✅ 编辑资料功能 - 100%
- ✅ 数据验证功能 - 100%
- ✅ 数据保存功能 - 100%
- ✅ 数据回显功能 - 100%
- ✅ UI交互效果 - 100%
- ✅ 数据同步功能 - 100%
- ✅ 错误处理功能 - 100%

## 💡 使用建议

1. **首次使用**
   - 如实填写身体数据
   - 体脂率如不确定可暂时不填
   - 保存后查看 BMI 和健康评分

2. **定期更新**
   - 建议每周测量一次体重
   - 定期更新体脂率数据
   - 观察数据变化趋势

3. **目标设定**
   - 根据 BMI 评估设定合理目标
   - 参考理想体重范围
   - 制定渐进式减重计划

---

**测试完成后，如有任何问题，请查看控制台错误信息或联系技术支持。**

**健康伙伴 v1.0.0** - 编辑功能完全可用！✨

